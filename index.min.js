(function(a,b){if(a.window&&typeof define==="function"&&define.amd){define(function(d){var e=d("./lib/promise.js");return b(e);});}else{if(module&&module.exports){var c=require("./lib/promise.js");
module.exports=b(c);}}})(this,function(c){c.chain=function e(m,i,n){var h=0,l=m,k=i.length;function j(){while(i.length){(function(o){l=l.then(function(p){h++;
return promise(function(q,r){o(p,q,r);});});})(i.shift());}}j();return c.then(function(o){j=null;return n(null,o,h,k);},function(o){j=null;return n(o,null,h,k)||o;
});};c.makePromiseArray=function b(h,l,j){var n=0,o=h.length,k=[],m=[];while(n<o){(function(q,p){var r=Array.isArray(q)?q:[q];q=null;k.push(function(u,i,t){l.apply(j||null,r.concat(function(v,s){if(v||v===false){t(v);
}else{m.push(s||true);i(p===o-1?m:true);}}));});})(h[n],n);n++;}return k;};c.makeChaining=function f(i,h){return function j(m,k,l){return i(m,function(n){return k(h(n));
},l);};};c.memory=function a(h){return function(k,j,i){i=i||c.defaultReject;return c(function(m,n){var l=function l(p,o){if(p){n(p);}else{m(o);}setImmediate(function(){l=null;
k=null;});};if(Array.isArray(k)){h.apply(null,k.concat(l));}else{h(k,l);}}).then(j,i);};};c.foreverRun=function d(k,i,h){(function j(){if(i()===false){h();
}else{setTimeout(j,k);}})();};c.forever=function g(i,j,h,k){if(!k){j=j.bind(i||null);}c(j).then(function(){foreverChain(i,j,h,true);},h);};return c;});

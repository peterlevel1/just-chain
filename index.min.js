(function(a,b){if(a.window&&typeof define==="function"&&define.amd){define(function(d){var e=d("./lib/promise.js");return b(e);});}else{if(module&&module.exports){var c=require("./lib/promise.js");
module.exports=b(c);}}})(this,function(d){var c=c||function(i){setTimeout(function(){i();},0);};d.chain=function f(n,j,o){var i=0,m=n,l=j.length;function k(){while(j.length){(function(p){m=m.then(function(q){i++;
return promise(function(r,t){p(q,r,t);});});})(j.shift());}}k();return d.then(function(p){k=null;return o(null,p,i,l);},function(p){k=null;return o(p,null,i,l)||p;
});};d.makePromiseArray=function b(j,m,k){var o=0,p=j.length,l=[],n=[];while(o<p){(function(r,q){var s=Array.isArray(r)?r:[r];r=null;l.push(function(u,i,t){m.apply(k||null,s.concat(function(w,v){if(w||w===false){t(w);
}else{n.push(v||true);i(q===p-1?n:true);}}));});})(j[o],o);o++;}return l;};d.makeChaining=function g(j,i){return function k(n,l,m){return j(n,function(o){return l(i(o));
},m);};};d.memory=function a(i){return function(l,k,j){j=j||d.defaultReject;return d(function(n,o){var m=function m(q,p){if(q){o(q);}else{n(p);}c(function(){m=null;
l=null;});};if(Array.isArray(l)){i.apply(null,l.concat(m));}else{i(l,m);}}).then(k,j);};};d.foreverRun=function e(l,j,i){(function k(){if(j()===false){i();
}else{setTimeout(k,l);}})();};d.forever=function h(j,k,i,l){if(!l){k=k.bind(j||null);}d(k).then(function(){foreverChain(j,k,i,true);},i);};return d;});
